<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Finished Goods Traceability</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <script>var plEnvironment = (window.location.href && window.location.href.indexOf("localhost")>=0)
        ? ' localhost'
        : (window.location.href && window.location.href.indexOf("-dev.pharmaledger.")>=0)
        ? ' DEV'
        : '';
        document.title = document.title + plEnvironment;
    </script>

</head>
<body>
    <div class="center-aligned-controls vertical-align">

        <a class="dsu-fabric_button scale-up" href="fgt-mah-wallet/loader/" target="_blank">
            <div class="left-side">
                <img src="assets/images/factory.png" alt="MAH-app">
            </div>
            <div class="right-side">
                <p>MAH wallet</p>
            </div>
        </a>

        <a class="leaflet-wallet_button scale-up" href="fgt-wholesaler-wallet/loader/" target="_blank">
            <div class="left-side">
                <img src="assets/images/wholesaler.png" alt="Wholesaler-App">
            </div>
            <div class="right-side">
                <p>Wholesaler Wallet</p>
            </div>
        </a>

        <a class="web-wallet_button scale-up" href="fgt-pharmacy-wallet/loader" target="_blank">
            <div class="left-side">
                <img src="assets/images/pharmacy.png" alt="Pharmacy-App">
            </div>
            <div class="right-side">
                <p>Pharmacy Wallet</p>
            </div>
        </a>


        <a class="web-wallet_button scale-up" href="dsu-explorer/loader/" target="_blank">
            <div class="left-side">
                <img src="assets/images/cube.png" alt="DSU-Explorer">
            </div>
            <div class="right-side">
                <p>DSU Explorer</p>
            </div>
        </a>
    </div>
    <div>
        <h1><img src="assets/images/pharmaledgerLogo.png" alt="Pharmaledger" style="height: 2em; vertical-align: middle; margin-right: 1em;">Finished Goods Traceability
            Demo<script>document.write(plEnvironment);</script></h1>

        <p>Demonstration of order and shipment management, mapping traceability of every lot (batch) using blockchain - through
            <a href="http://opendsu.com" target="_blank">OpenDSU</a> technology.</p>

        <p>The web applications above (which should be easily compiled to native mobile Android/iOS applications) are just for
            demonstration purposes, and will not exist in the future (so, no real effort was done on usability with large data
            volumes). The <span style="font-weight: bold;">long-term vision</span> is that every company (MAH, Wholesaler,
            Pharmacy) already has their own
            ERPs, and integration with the blockchain should be provided by web service gateways that translate the existing
            order/shipment management ERP operations on to blockchain read/write operations (so that each company operates as
            usual as they already do today).</p>

        <div id="credentials" style="display: none;">
            <p>Below are the necessary credentials to login with some pre-generated data.</p>
            <p>For each participant change only the ID. all the other credentials remain the same.</p>
            <p>To view the contents of each Participant SSApp, use the keys below in the Dossier Explorer</p>
            <table>
                <tr>
                    <th>Marketing Authorization Holder</th>
                    <th>Wholesaler</th>
                    <th>Pharmacy</th>
                </tr>
                <tr>
                    <td id="id-mah"></td>
                    <td id="id-whs"></td>
                    <td id="id-pha"></td>
                </tr>
                <tr>
                    <td id="key-mah"></td>
                    <td id="key-whs"></td>
                    <td id="key-pha"></td>
                </tr>
            </table>
        </div>

        <p><span style="font-weight: bold;">WARNING:</span> Unstable software and environments. Use at your own risk! Data persistence at risk of un-expected reset!</p>

        <h2>v0.3.0 Release notes 2021-06-23</h2>

        <p>Technological architecture refactoring (using ionic components) complete;</p>
        <p>Re-Design according to PharmaLedger's Style rules complete;</p>
        <p>Communication between Participant Wallets achieved;</p>
        <p>Creation and transmission of orders complete;</p>
        <p>Creation and transmission of shipments complete;</p>
        <p>Creation and transmission of orderLines complete - deprecated - will be removed for the next release!;</p>
        <p>Creation and transmission of shipmentLines complete;</p>
        <p>Auto Instantiation of Participant Wallets with dummy data complete (we await proper 'real' data to start recreating a proper business environment);</p>

        <h3>Upcoming developments for the next release:</h3>
        <p>Order And Shipment status update;</p>
        <p>Final product state implementation (ADMINISTERED);</p>
        <p>Traceability on the batch level after product is in final state;</p>
        <p>Implicit stock evaluation for all chain of custody participants by the MAH for their products;</p>

        <p>Milestones achieved on this release, compared to the plan 2021-01-20_ImplementationPlanMVPFinishedGoodsTraceability.docx:</p>
        <ul>
            <li>M1 OpenDSU Solution Concept Complete - 100% - PDM's Architecture concept/Framework complete and stable.</li>
            <li>M2 Development Environment Setup Complete - complete 100% - development environment available at <a href="https://fgt-dev.pharmaledger.pdmfc.com/">https://fgt-dev.pharmaledger.pdmfc.com/</a>. (Data persistence and other configuration tasks still in progress).</li>
            <li>M3 Business Test Environment Setup Complete - complete 100% - environment available at <a href="https://fgt.pharmaledger.pdmfc.com/">https://fgt.pharmaledger.pdmfc.com/</a>. (Data persistence and other configuration tasks still in progress).</li>
        </ul>

        <h2>v0.2.1 Release notes 2021-05-03</h2>

        <p>Technological architecture refactoring (using ionic components). Data preloading instructions soon.</p>

        <h2>Release notes 2021-03-26</h2>

        <p>Application description / testing instructions</p>
        <ul>
            <li><img src="assets/images/factory.png" style="height: 1em;"> MAH (Marketing Authorization Holder) App:
                <ol>
                    <li>On the first usage, you need to register a username password to open the wallet. (Re-used from ePi)</li>
                    <li>On the first opening of the wallet, you need to register details of a MAH company. <b>Only a single user is supported for that company at this version.</b></li>
                    <li>After these 2 initial register steps (which will be merged into one), you may create Products (new GTINs) and create Batches (commission new product batches).</li>
                </ol>
            </li>
            <li><img src="assets/images/wholesaler.png" style="height: 1em;"> Wholesaler Wallet - experimenting new graphical layout and registration process.</li>
            <li><img src="assets/images/pharmacy.png" style="height: 1em;"> Pharmacy Wallet:
                <ol>
                    <li>Same initial 2 registration steps as in the MAH app.</li>
                    <li>After these 2 initial register steps (which will be merged into one), you may create orders for Products.</li>
                </ol>
            </li>
            <li><img src="assets/images/cube.png" style="height: 1em;"> DSU Explorer - debug tool to explore DSUs anchored on the blockchain (Re-used from ePi).</li>
        </ul>
        Wallets do not communicate yet, so nothing done on one wallet is visible on other wallets.

        <p>Milestones achieved on this release, compared to the plan 2021-01-20_ImplementationPlanMVPFinishedGoodsTraceability.docx:</p>
        <ul>
            <li>M1 OpenDSU Solution Concept Complete - partial 50% - work in progress in DSU constitution and attributes.</li>
            <li>M2 Development Environment Setup Complete - complete 80% - development environment available at <a href="https://fgt-dev.pharmaledger.pdmfc.com/">https://fgt-dev.pharmaledger.pdmfc.com/</a>. (Data persistence and other configuration tasks still in progress).</li>
            <li>M3 Business Test Environment Setup Complete - complete 80% - environment available at <a href="https://fgt.pharmaledger.pdmfc.com/">https://fgt.pharmaledger.pdmfc.com/</a>. (Data persistence and other configuration tasks still in progress).</li>
        </ul>

        <p>PDM welcomes technical contributions at <a href="https://github.com/PharmaLedger-IMI/fgt-workspace">https://github.com/PharmaLedger-IMI/fgt-workspace</a></p>
    </div>
    <footer>
        v<!-- VERSION_START -->0.2.2-g84d1260<!-- VERSION_END --> &copy;&nbsp;2021 <a href="http://pharmaledger.eu">Pharmaledger.eu</a> - All Rights Reserved.
    </footer>

    <script type="application/javascript">

        const displayCredentials = function(credentials){
            const byWallet = credentials.reduce((accum, cred) => {
                accum[cred.type] = accum[cred.type] || [];
                accum[cred.type].push(...cred.created);
                return accum;
            }, {});

            document.getElementById('id-mah').innerText = byWallet['fgt-mah-wallet'][0].id;
            document.getElementById('id-whs').innerText = byWallet['fgt-wholesaler-wallet'][0].id;
            document.getElementById('id-pha').innerText = byWallet['fgt-pharmacy-wallet'][0].id;

            document.getElementById('key-mah').innerText = byWallet['fgt-mah-wallet'][0].ssi;
            document.getElementById('key-whs').innerText = byWallet['fgt-wholesaler-wallet'][0].ssi;
            document.getElementById('key-pha').innerText = byWallet['fgt-pharmacy-wallet'][0].ssi;

            document.getElementById('credentials').style.display = "block";
        }

        const getCredentials = function(){
            const credentialsFile = new XMLHttpRequest();
            credentialsFile.open("GET", './credentials.json', true);
            credentialsFile.send();
            credentialsFile.onreadystatechange = function() {
                if (credentialsFile.readyState === 4 && credentialsFile.status === 200)
                    displayCredentials(JSON.parse(credentialsFile.responseText));
            }
        }

        getCredentials();
    </script>
</body>

</html>
